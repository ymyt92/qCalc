(function(){"use strict";var e={9375:function(e,t,a){var n=a(2856),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("QiMen",{ref:"qiMen"})],1)},r=[],l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"qCalc"},[t("div",{staticClass:"header"},[t("p",[e._v("奇门遁甲计算器")]),t("div",[t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){e.qCalcForm={}}}},[e._v("重置")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.exportDoc}},[e._v("导出")])],1)]),t("el-form",{staticClass:"qCalc-square",attrs:{size:"mini",model:e.qCalcForm,"label-position":"left"}},e._l(9,function(a){return t("div",{class:["square","s"+a]},[5!==a?[t("div",{staticClass:"cell c1"},[t("p",{staticClass:"sum"},[e._v(e._s(e.getSquareScore(a)))]),t("el-popover",{attrs:{placement:"right-end",title:"计分详情",width:"520",trigger:"click"}},[t("el-table",{attrs:{data:e.sumDetailObj[a],border:"",stripe:""}},[t("el-table-column",{attrs:{label:"类型",prop:"type"}}),t("el-table-column",{attrs:{label:"分数",prop:"score"}}),t("el-table-column",{attrs:{label:"值",prop:"value",width:"120"}}),t("el-table-column",{attrs:{label:"备注",prop:"mean",width:"180"}})],1),t("i",{staticClass:"el-icon-view",attrs:{slot:"reference"},slot:"reference"})],1)],1),t("div",{staticClass:"cell c2"},[t("el-form-item",[t("el-select",{attrs:{clearable:""},model:{value:e.qCalcForm[`s${a}_shenZhu`],callback:function(t){e.$set(e.qCalcForm,`s${a}_shenZhu`,t)},expression:"qCalcForm[`s${s}_shenZhu`]"}},e._l(e.shenZhuMap,function(e,a){return t("el-option",{key:a,attrs:{label:a,value:a}})}),1)],1)],1),t("div",{staticClass:"cell c3"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.qCalcForm[`s${a}_kongWang`],expression:"qCalcForm[`s${s}_kongWang`]"}],staticClass:"circle"}),t("el-popover",{attrs:{placement:"bottom",title:"配置",width:"200",trigger:"click","append-to-body":!1}},[3===a?t("el-form-item",{attrs:{label:"遁甲","label-width":"40px"}},[t("el-select",{attrs:{size:"mini",clearable:""},on:{change:e.setDunjia},model:{value:e.dunjia,callback:function(t){e.dunjia=t},expression:"dunjia"}},e._l(["戊","己","庚","辛","壬","癸"],function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e(),t("el-form-item",{attrs:{label:"空亡"}},[t("el-radio-group",{model:{value:e.qCalcForm[`s${a}_kongWang`],callback:function(t){e.$set(e.qCalcForm,`s${a}_kongWang`,t)},expression:"qCalcForm[`s${s}_kongWang`]"}},[t("el-radio",{attrs:{label:!0}},[e._v("是")]),t("el-radio",{attrs:{label:void 0}},[e._v("否")])],1)],1),t("i",{staticClass:"hai-setting el-icon-setting",attrs:{slot:"reference"},slot:"reference"})],1)],1),t("div",{staticClass:"cell c4"}),t("div",{staticClass:"cell c5"},[t("el-form-item",[t("el-select",{attrs:{clearable:""},model:{value:e.qCalcForm[`s${a}_tianShi`],callback:function(t){e.$set(e.qCalcForm,`s${a}_tianShi`,t)},expression:"qCalcForm[`s${s}_tianShi`]"}},e._l(e.tianShiMap,function(e,a){return t("el-option",{key:a,attrs:{label:a,value:a}})}),1)],1),t("span",{staticClass:"square-type"},[e._v(e._s(e.squareNameMap["s"+a]))])],1),t("div",{staticClass:"cell c6"},[t("el-form-item",[t("el-cascader",{attrs:{options:e.zs12Casc,props:{checkStrictly:!0},clearable:""},model:{value:e.qCalcForm[`s${a}_zs12`],callback:function(t){e.$set(e.qCalcForm,`s${a}_zs12`,t)},expression:"qCalcForm[`s${s}_zs12`]"}})],1),t("el-form-item",{class:e.getTianGanColor(a,e.qCalcForm[`s${a}_sky`])},[t("el-select",{attrs:{clearable:""},model:{value:e.qCalcForm[`s${a}_sky`],callback:function(t){e.$set(e.qCalcForm,`s${a}_sky`,t)},expression:"qCalcForm[`s${s}_sky`]"}},e._l(e.tianganMap,function(n,s){return t("el-option",{key:s,class:e.getTianGanColor(a,s),attrs:{label:s,value:s}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(s))]),t("span",{staticStyle:{float:"right"}},[e._v(e._s(n))])])}),1)],1)],1),t("div",{staticClass:"cell c7"}),t("div",{staticClass:"cell c8"},[t("el-form-item",{class:{red:e.menPoMap["s"+a].includes(e.qCalcForm[`s${a}_renHe`])}},[t("el-select",{attrs:{clearable:""},model:{value:e.qCalcForm[`s${a}_renHe`],callback:function(t){e.$set(e.qCalcForm,`s${a}_renHe`,t)},expression:"qCalcForm[`s${s}_renHe`]"}},e._l(e.renHeMap,function(n,s){return t("el-option",{key:s,class:{red:e.menPoMap["s"+a].includes(s)},attrs:{label:s,value:s}})}),1)],1)],1),t("div",{staticClass:"cell c9"},[t("el-form-item",{class:e.getTianGanColor(a,e.qCalcForm[`s${a}_earth`])},[t("el-select",{attrs:{clearable:""},model:{value:e.qCalcForm[`s${a}_earth`],callback:function(t){e.$set(e.qCalcForm,`s${a}_earth`,t)},expression:"qCalcForm[`s${s}_earth`]"}},e._l(e.tianganMap,function(n,s){return t("el-option",{key:s,class:e.getTianGanColor(a,s),attrs:{label:s,value:s}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(s))]),t("span",{staticStyle:{float:"right"}},[e._v(e._s(n))])])}),1)],1)],1)]:e._e()],2)}),0)],1)},i=[],o=(a(4114),a(8111),a(1701),a(8237),a(953)),c=a(3580),u=a(4533),m=a.n(u),p={data(){return{qCalcForm:{},squareScoreMap:{},sumDetailObj:{},sumMap:{},shenZhuMap:{"值符":{mean:"吉神",score:20},"太阴":{mean:"吉神",score:20},"六合":{mean:"吉神",score:20},"九天":{mean:"吉神",score:20},"腾蛇":{mean:"凶神",score:0},"白虎":{mean:"凶神",score:0},"玄武":{mean:"凶神",score:0},"九地":{mean:"吉神",score:0}},tianShiMap:{"天任星":{mean:"吉星",score:20},"天冲星":{mean:"吉星",score:20},"天辅星":{mean:"吉星",score:20},"天心星":{mean:"吉星",score:20},"天禽星":{mean:"吉星",score:20},"天蓬星":{mean:"凶星",score:0},"天英星":{mean:"凶星",score:0},"天芮星":{mean:"凶星",score:0},"天柱星":{mean:"凶星",score:0}},renHeMap:{"休门":{mean:"吉门",score:30},"生门":{mean:"吉门",score:30},"开门":{mean:"吉门",score:30},"杜门":{mean:"平门",score:0},"景门":{mean:"平门",score:0},"死门":{mean:"凶门",score:0},"惊门":{mean:"凶门",score:0},"伤门":{mean:"凶门",score:0}},tianganMap:{"甲":"阳木","乙":"阴木","丙":"阳火","丁":"阴火","戊":"阳土","己":"阴土","庚":"阳金","辛":"阴金","壬":"阳水","癸":"阴水"},zs12Map:{"长":{mean:"上升期",score:30},"沐":{mean:"上升期",score:30},"冠":{mean:"上升期",score:30},"临":{mean:"上升期",score:30},"旺":{mean:"上升期",score:30},"衰":{mean:"衰退期",score:10},"病":{mean:"衰退期",score:10},"死":{mean:"衰退期",score:10},"墓":{mean:"衰退期",score:0},"绝":{mean:"恢复期",score:10},"胎":{mean:"恢复期",score:20},"养":{mean:"恢复期",score:20}},wuxing:["木","火","土","金","水"],squareTypeMap:{s1:"木",s2:"火",s3:"土",s4:"木",s5:"土",s6:"金",s7:"土",s8:"水",s9:"金"},squareNameMap:{s1:"巽",s2:"离",s3:"坤",s4:"震",s5:"中",s6:"兑",s7:"艮",s8:"坎",s9:"乾"},menPoMap:{s1:["开门","惊门"],s2:["休门"],s3:["伤门","杜门"],s4:["开门","惊门"],s6:["景门"],s7:["伤门","杜门"],s8:["生门","死门"],s9:["景门"]},jiXingMap:{s1:["壬","癸"],s2:["辛"],s3:["己"],s4:["戊"],s7:["庚"]},ruMuMap:{s1:["壬","辛"],s3:["甲","癸"],s7:["丁","己","庚"],s9:["乙","丙","戊"]},xjmMap:{s1:["壬"],s7:["庚"]},dunjia:""}},computed:{zs12Casc(){let e=Object.keys(this.zs12Map),t=e.map((t,a)=>{let n=[...e.slice(0,a),...e.slice(a+1)];n=n.map(e=>({label:e,value:e}));let s={label:t,value:t,children:n};return s});return t}},watch:{qCalcForm:{handler(e){let t={};for(let a in e){let n=a.split("_"),s=n[0],r=n[1],l=t[s];l||(t[s]={},l=t[s]),l[r]=e[a]}this.squareScoreMap=t,localStorage.setItem("qCalcForm",JSON.stringify(e))},deep:!0}},mounted(){let e=localStorage.getItem("qCalcForm");this.qCalcForm=e?JSON.parse(e):{}},methods:{getSquareScore(e){let t="s"+e,a=this.squareScoreMap[t],n=200,s={tianShi:"天时",diLi:"地利",renHe:"人和",shenZhu:"神助",zs12:"周期",diPanGan:"格局",menPo:"门迫",jiXing:"击刑",ruMu:"入墓",kongWang:"空亡"},r={};for(let i in a){let l=a[i],o=0;if(l&&l.length||1==l){if("tianShi"===i&&(o=this.tianShiMap[l].score,r[i]={type:s[i],value:l,score:o,mean:this.tianShiMap[l].mean}),"renHe"===i&&(o=this.renHeMap[l].score,r[i]={type:s[i],value:l,score:o,mean:this.renHeMap[l].mean},this.menPoMap[t].includes(l)&&(r["menPo"]={type:s["menPo"],value:`${l}在${this.squareNameMap[t]}宫`,score:-20,mean:"门克宫"},o+=-20)),"shenZhu"===i&&(o=this.shenZhuMap[l].score,r[i]={type:s[i],value:l,score:o,mean:this.shenZhuMap[l].mean}),"zs12"===i){let e=l[0],t=this.zs12Map[e].score,a=l[1];a&&(t+=this.zs12Map[a].score),o=t/l.length,r[i]={type:s[i],value:l.join(""),score:o,mean:`${e}:${this.zs12Map[e].mean}${a?`,${a}:${this.zs12Map[a].mean}`:""}`}}if("sky"===i){let n=this.squareTypeMap[t],i=this.getTianGanwuxing(l),c=this.calcWxRelation(i,n,"diLi");o=c.score,r["diLi"]={type:s["diLi"],value:`我:${i},宫:${n}`,score:o,mean:c.text};let u=a["earth"];if(u){let e=this.getTianGanwuxing(u),t=this.calcWxRelation(e,i,"diPanGan"),a=t.score;r["diPanGan"]={type:s["diPanGan"],value:`天:${i},地:${e}`,score:a,mean:t.text},o+=a}if(this.jiXingMap[t]){let e=!1;if(e=this.jiXingMap[t].includes(l),e)r["jiXing"]={type:s["jiXing"],value:`${l}在${this.squareNameMap[t]}宫`,score:-20,mean:"天盘干击刑"},o+=-20;else if(u){let e=this.jiXingMap[t].includes(u);e&&(r["jiXing"]={type:s["jiXing"],value:`${u}在${this.squareNameMap[t]}宫`,score:-10,mean:"地盘干击刑"},o+=-10)}}if(this.ruMuMap[t]){let a=!1;if(a=this.ruMuMap[t].includes(l),a)r["ruMu"]={type:s["ruMu"],value:`${l}在${this.squareNameMap[t]}宫`,score:-30,mean:"天盘干入墓"},3===e&&this.dunjia&&(r["ruMu"].mean+=`(遁甲:${this.dunjia})`),o+=-30;else if(u){let a=this.ruMuMap[t].includes(u);a&&(r["ruMu"]={type:s["ruMu"],value:`${u}在${this.squareNameMap[t]}宫`,score:-15,mean:"地盘干入墓"},3===e&&this.dunjia&&(r["ruMu"].mean+=`(遁甲:${this.dunjia})`),o+=-15)}}}"kongWang"===i&&(r["kongWang"]={type:s["kongWang"],value:"是",score:-30,mean:""},o+=-30)}n+=o}let l=[{type:"基础分",score:200}];for(let i in s){let e=r[i];e&&l.push(e)}return this.sumDetailObj[e]=l,this.sumMap[e]=n,n},getTianGanwuxing(e){let t=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],a=["木","火","土","金","水"],n=t.indexOf(e),s=e=>e%2===0;return s(n)?a[n/2]:a[(n-1)/2]},calcWxRelation(e,t,a){let n=["木","火","土","金","水"],s=n.indexOf(e),r=[...n.slice(s),...n.slice(0,s)];s=0;let l=r.indexOf(t),i=Math.abs(s-l);if(!a)return i;if("diLi"===a){let e={0:{score:30,text:"我同宫--平顺有成(中吉)"},1:{score:0,text:"我生宫--多有消耗(小凶)"},2:{score:10,text:"我克宫--努力有得(小吉)"},3:{score:0,text:"宫克我--多阻无成(大凶)"},4:{score:30,text:"宫生我--得地支助(大吉)"}};return e[i]}if("diPanGan"===a){let e={0:{score:30,text:"地同天"},1:{score:30,text:"地生天"},2:{score:0,text:"地克天"},3:{score:20,text:"天克地"},4:{score:20,text:"天生地"}};return e[i]}},getTianGanColor(e,t){if(!t)return"";let a="s"+e,n=[this.xjmMap,this.jiXingMap,this.ruMuMap],s=n.find(e=>{let n=!1;return e[a]&&e[a].includes(t)&&(n=!0),n});if(s){let e=n.indexOf(s),t={0:"blue",1:"purple",2:"green"};return t[e]}return""},setDunjia(e){this.xjmMap.s3&&delete this.xjmMap.s3,e?(this.ruMuMap.s3.includes(e)||(this.ruMuMap.s3=["甲","癸",e]),"己"===e&&(this.xjmMap.s3=["己"])):this.ruMuMap.s3=["甲","癸"]},getDocTables(){let e=[];for(let t=1;t<=9;t++){let a=this.sumDetailObj[t];if(a&&a.length>1){let n=this.squareNameMap["s"+t]+"宫："+this.sumMap[t];e.push(new o.fzL({text:n,heading:o.Fmo.HEADING_1})),e.push(new o.fzL(""));let s=["type","score","value","mean"],r=new o.XIK({rows:[new o.Hjg({children:[new o.nA6({children:[new o.fzL({children:[new o.NTc({text:"类型",bold:!0})],alignment:"center"})]}),new o.nA6({children:[new o.fzL({children:[new o.NTc({text:"分数",bold:!0})],alignment:"center"})]}),new o.nA6({children:[new o.fzL({children:[new o.NTc({text:"值",bold:!0})],alignment:"center"})]}),new o.nA6({children:[new o.fzL({children:[new o.NTc({text:"备注",bold:!0})],alignment:"center"})]})]}),...a.map(e=>new o.Hjg({children:s.map(t=>new o.nA6({children:e.hasOwnProperty(t)?[new o.fzL(String(e[t]))]:[]}))}))],width:{size:100,type:"pct"},margins:{top:100,bottom:100,left:100,right:100}});e.push(r),e.push(new o.fzL(""))}}return e},exportDoc(){m()(this.$el.querySelector(".qCalc-square"),{ignoreElements:e=>"el-input__suffix"===e.className||"el-popover__reference-wrapper"===e.className||(!(!e.hasAttribute("placeholder")||e.value)||void 0)}).then(e=>{let t=e.toDataURL("image/png"),a=new o.yoT({sections:[{children:[new o.fzL({text:"排盘计分表",heading:o.Fmo.TITLE,alignment:"center"}),new o.fzL(""),new o.fzL({children:[new o.NTc({text:"排盘图"}),new o.J1n({data:t,transformation:{width:600,height:600}})],alignment:"center"}),new o.fzL(""),new o.fzL({children:[new o.NTc({text:"总分:"+Object.values(this.sumMap).reduce((e,t)=>e+t)}),new o.bjD]}),...this.getDocTables()]}]});o.ND6.toBlob(a).then(e=>{(0,c.saveAs)(e,"排盘详情表.docx")})})}}},h=p,d=a(1656),f=(0,d.A)(h,l,i,!1,null,null,null),g=f.exports,v={components:{QiMen:g}},M=v,b=(0,d.A)(M,s,r,!1,null,null,null),_=b.exports,C=a(4927),q=a.n(C),w=a(4071),y=a.n(w);n["default"].config.productionTip=!1,n["default"].use(q()),n["default"].use(y()),new n["default"]({render:e=>e(_)}).$mount("#app")}},t={};function a(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=e,function(){a.amdO={}}(),function(){var e=[];a.O=function(t,n,s,r){if(!n){var l=1/0;for(u=0;u<e.length;u++){n=e[u][0],s=e[u][1],r=e[u][2];for(var i=!0,o=0;o<n.length;o++)(!1&r||l>=r)&&Object.keys(a.O).every(function(e){return a.O[e](n[o])})?n.splice(o--,1):(i=!1,r<l&&(l=r));if(i){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,s,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,r,l=n[0],i=n[1],o=n[2],c=0;if(l.some(function(t){return 0!==e[t]})){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(o)var u=o(a)}for(t&&t(n);c<l.length;c++)r=l[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},n=self["webpackChunkqCalc"]=self["webpackChunkqCalc"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],function(){return a(9375)});n=a.O(n)})();
//# sourceMappingURL=app.8b19a5c5.js.map